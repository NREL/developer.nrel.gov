<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
        Data Download Guide 
          API
        |
      NREL: Developer Network
    </title>

    <link rel="canonical" href="https://developer.nrel.gov/docs/wave/guide/" />
    <script>
      if(window.location.href.indexOf('nrel.github.io') !== -1) {
        window.location.href = 'https://developer.nrel.gov/docs/wave/guide/';
      }
    </script>

    <link href="/assets/stylesheets/all-050578d9.css" rel="stylesheet" />

    <script src="/assets/javascripts/shared-8f31eae2.js"></script>
    <script src="/assets/javascripts/all-172ea8d4.js"></script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');
</script>

  </head>
  <body class="docs docs_wave docs_wave_guide docs_wave_guide_index">
    <div class="container">
  <header>
    <map name="header_map">
        <area shape="rect" coords="0,0,840,58" href="/" alt="Developer Network" />
      <area shape="rect" coords="840,0,1000,58" href="http://www.nrel.gov/" alt="NREL" />
    </map>
    <img src="/assets/images/nrel/header-1bfbcb1a.png" alt="NREL Developer Network" usemap="#header_map" width="1000" height="58" class="img-fluid" />
  </header>
  <nav class="navbar navbar-expand-md navbar-dark bg-primary">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar_nav" aria-controls="navbar_nav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbar_nav">
      <ul class="navbar-nav">
        <li class="nav-item nav-home "><a href="/" class="nav-link">Home</a></li>
        <li class="nav-item nav-documentation active"><a href="/docs" class="nav-link">Documentation</a></li>
        <li class="nav-item nav-community "><a href="/community" class="nav-link">Community</a></li>
      </ul>
    </div>
  </nav>

      <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/docs/">Documentation</a></li>
            <li class="breadcrumb-item"><a href="/docs/wave/">Wave</a></li>
            <li class="breadcrumb-item active">Data Download Guide</li>
    </ol>


    <h2 id="data-download-usage-guide">Data Download Usage Guide</h2>

<p>We often receive requests from users interested in downloading larger segments of the data than are supported by the API. It is important to understand that these datasets are large. Currently our storage archive contains hundreds of terabytes of data and is constantly growing! In order to reliably serve dynamic segments of a dataset of this size to a growing community of users we have calculated the maximum capacity our server hardware can sustain. We use this physical capacity to determine our API rate limits.</p>

<p>The API is restricted in several ways including the number of simultaneous requests a single user can make, the number of requests a single user can make in a 24 hour period, as well as in the maximum size of a single request. The API rate limits are set at:</p>

<blockquote>
  <p>1000 requests per day<br />
1 request every 2 seconds<br />
20 requests in process at once</p>
</blockquote>

<p>For downloading directly via CSV there are separate rate limits. This is due to the fact that it is only possible to download a single site for a single year via the CSV endpoint, therefor these requests are always quite small by comparison:</p>

<blockquote>
  <p>5000 requests per day<br />
1 request per second<br />
20 requests in process at once</p>
</blockquote>

<p>The size limit per each single request is determined by the number of total attributes in each request. The maximum weight of each request is <strong>1000000</strong>. The calculation for determining the weight of each request is:</p>

<blockquote>
  <p><em>site-count*attribute-count*year-count*data-intervals-per-year</em></p>
</blockquote>

<ul>
  <li><strong>site-count</strong> is derived from the WKT value submitted and can be retrieved using the <a href="/docs/solar/nsrdb/site-count">site_count</a> API endpoint.</li>
  <li><strong>attribute-count</strong> is equal to the number of attributes requested</li>
  <li><strong>year-count</strong> is equal to the number of years requested</li>
  <li><strong>data-intervals-per-year</strong> is <em>((60/interval)*24*365)</em> where interval is the interval requested</li>
</ul>

<p>To maximize a single request simply minimize the variables wherever possible. For example by requesting half as many attributes one can request twice as many years (or sites) worth of data.</p>

<p>Imagine a use case where one wanted to download all wave data on the coast of Hawaii. The first step would be to refine the request down to the least number of attributes, years, and intervals possible. From that one could determine the number of sites that could be requested in a single request. By experimenting with the <a href="/docs/solar/nsrdb/site-count">site_count</a> endpoint a polygon size could be identified that intersects close to that many sites. Using that polygon size create a grid that covers all of the coastline of Hawaii. The final step would be to write a script that invokes the API once for every required grid cell at a rate of no more than 1 every 2 seconds and no more than 20 in process at a time. If more than 1000 requests are required the script will have to be continued across multiple days.</p>

<p>In cases where a very large WKT value is required, e.g. downloading the maximum number of broadly spaced points at a time using a MULTIPOINT wkt, it is possible to POST a request to the API providing the WKT params in the payload. Here is an example of a Python script that uses this variation:</p>

<div class="highlight"><pre class="highlight python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="s">"https://developer.nrel.gov/api/wave/v2/wave/hawaii-hindcast-download.json?api_key=yourapikeygoeshere"</span>

<span class="n">payload</span> <span class="o">=</span> <span class="s">"utc=true&amp;leap_day=true&amp;interval=180&amp;email=user@company.com&amp;wkt=POINT(-164 15)&amp;names=2010"</span>

<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'content-type'</span><span class="p">:</span> <span class="s">"application/x-www-form-urlencoded"</span><span class="p">,</span>
    <span class="s">'cache-control'</span><span class="p">:</span> <span class="s">"no-cache"</span>
<span class="p">}</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">request</span><span class="p">(</span><span class="s">"POST"</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
</code></pre></div>
<p>And a CURL example of the same</p>

<div class="highlight"><pre class="highlight shell"><code>curl <span class="nt">-X</span> POST <span class="nt">-H</span> <span class="s2">"Content-Type: application/x-www-form-urlencoded"</span> <span class="nt">-H</span> <span class="s2">"Cache-Control: no-cache"</span> <span class="nt">-d</span> <span class="s1">'utc=true&amp;leap_day=true&amp;interval=180&amp;email=user@company.com&amp;wkt=POINT(-164 15)&amp;names=2010'</span> <span class="s2">"http://developer.nrel.gov/api/wave/v2/wave/hawaii-hindcast-download.json?api_key=yourapikeygoeshere"</span>
</code></pre></div>
    <div style="text-align: center; font-style: italic; padding: 3em 0.5em 0em 0.5em;">
  <a href="https://github.com/NREL/developer.nrel.gov/blob/master/source/docs/wave/guide.html.md.erb">Help Improve this Content</a>
</div>

      <footer class="container-fluid">
    <div align="center"><img src="/assets/images/nrel/foot_nrelis-8e56f120.gif" alt="NREL is a national laboratory of the U.S. Department of Energy, Office of Energy Efficiency and Renewable Energy, operated by the Alliance for Sustainable Energy, LLC." usemap="#footer_map" class="img-fluid" /></div>

    <map name="footer_map" id="footer_map">
      <area shape="rect" coords="27,7,61,20" href="http://www.nrel.gov/" alt="NREL" />
      <area shape="rect" coords="238,7,399,19" href="http://www.energy.gov/" alt="U.S. Department of Energy" />
      <area shape="rect" coords="405,7,697,21" href="http://www.eere.energy.gov/" alt="Office of Energy Efficiency and Renewable Energy" />
      <area shape="rect" coords="307,21,524,35" href="http://www.allianceforsustainableenergy.org/" alt="Alliance for Sustainable Energy, LLC" />
    </map>

    <p><a href="/contact">Need Help?</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="http://www.nrel.gov/security.html">Security &amp; Privacy</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="http://www.nrel.gov/disclaimer.html">Disclaimer</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="http://www.nrel.gov/">NREL Home</a></p>
  </footer>
</div>

  </body>
</html>
